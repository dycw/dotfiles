#!/usr/bin/env bash
# shellcheck disable=SC1090,SC1091

if [[ $- != *i* ]]; then
    return
fi

#### history ##################################################################

HISTCONTROL=ignoreboth
HISTSIZE=1000
HISTFILESIZE=2000
shopt -s histappend

#### check window size ########################################################

shopt -s checkwinsize

#### completion ###############################################################

if ! shopt -oq posix; then
    if [ -f /usr/share/bash-completion/bash_completion ]; then
        . /usr/share/bash-completion/bash_completion
    elif [ -f /etc/bash_completion ]; then
        . /etc/bash_completion
    fi
fi

#### common POSIX #############################################################

for file in "${HOME}"/.config/posix/*.sh; do
    # restore original settings since 'set -u' (nounset) can brick /etc/profile.d/*
    current="$(set +o)"
    [ -f "${file}" ] && . "${file}"
    eval "${current}"
    unset current
done
